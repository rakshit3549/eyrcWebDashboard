<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
    integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

  <title>Vargi Bot</title>

  <link rel="icon"
    href="https://raw.githubusercontent.com/rakshit3549/eyrcWebDashboard/main/1x/image-invert-crop.png?token=AHUOKZCAYFX6JJABKD4D62DAG5VNK"
    type="image/x-icon">

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
    integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
    crossorigin="" />

  <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
    integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
    crossorigin="">
    </script>

  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

  <style>
    .leaflet-popup-content-wrapper {
      padding: 0;
    }

    .leaflet-popup-content-wrapper .leaflet-popup-content {
      margin: 0;
      padding: 0;
    }

    .leaflet-popup-content-wrapper h4 {
      padding: 10px 30px 3px 10px;
      margin-bottom: 3px;
      font-size: 15px;
      border-radius: 10px 10px 0 0;
      background-color: rgb(117, 119, 122);
      color: rgb(255, 255, 255);
    }

    .leaflet-popup-content-wrapper p {
      margin: 0 0 0 0;
      padding: 0 0 5px 10px;
      font-size: xx-large;
      color: rgb(17, 15, 15);
      font-size: 10px;

    }

    .info_box {
      position: relative;
      position: fixed;
      border-radius: 10px;
      z-index: 999;
      height: 90px;
      width: 150px;
      transform: translateX(100px);
      background: rgb(255, 255, 255);

    }
  </style>

</head>

<body>

  <div style="background-color: rgb(146, 146, 146);  " class="container-fluid p-0 ">
    <img style=" padding-bottom: 30px;"
      src="https://raw.githubusercontent.com/rakshit3549/eyrcWebDashboard/main/1x/FinalHeaderArtboard%201.png?token=AHUOKZHKGB5XGITHYMLJIUDAF7KT6"
      alt="Header Image" class="img-fluid">
  </div>

  <nav class="navbar  navbar-expand-lg navbar-expand-md navbar-dark sticky-top"
    style="background-color: rgba(0, 0, 0, 0.726);">
    <a class="navbar-brand" href="#">
      <img
        src="https://raw.githubusercontent.com/rakshit3549/eyrcWebDashboard/main/1x/image-invert-crop.png?token=AHUOKZB3PC4ANLTE7E37KYLAF7KJ2"
        alt="VargiBot Logo" width="40" height="40">
    </a>
    <a class="navbar-brand" href="#">वर्गी बॉट #VB0205</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse position " id="navbarSupportedContent">
      <ul class="navbar-nav text-primary mr-auto justify-content-end w-100 pr-5 ">
        <li class="nav-item active">
          <a class="nav-link" href="#home">Home <span class="sr-only">(current)</span></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#dashboard">Dashboard</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#aboutUs">About Us</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#contactUs">Contact Us</a>
        </li>
      </ul>
    </div>
  </nav>

  <div style="background-color: rgb(156, 159, 161);padding-top: 20px;">
    <div id="home" class="container-fluid p-0">
      <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators">
          <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
          <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
          <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
        </ol>

        <div
          style="border-top-left-radius: 20px ; border-top-right-radius: 20px ;background-color:rgba(20, 22, 24, 0.685);"
          class=" pb-5">
          <div class="carousel-inner">
            <div class="carousel-item active">
              <img class="d-block w-100"
                src="https://raw.githubusercontent.com/rakshit3549/eyrcWebDashboard/main/1x/roboArmArtboard%201.png?token=AHUOKZCC5A5Z5O77C5PDNC3AF7KMW"
                alt="First slide">
              <div class="carousel-caption d-none d-md-block">
                <p style="color: rgb(224, 161, 66);font-size: 30px;" class="m-0 pl-5">VargiBots</p>
                <p style="color: rgb(27, 41, 59);font-size: 19px;" class="pl-5">This is our Vargi Bots,It's a UR5 arm.
                  This two pair of arms do all <br> the Shipping related Tasks </p>
              </div>
            </div>
            <div class="carousel-item">
              <img class="d-block w-100"
                src="https://raw.githubusercontent.com/rakshit3549/eyrcWebDashboard/main/1x/roboArmDrone1Artboard%201.png?token=AHUOKZBWMZ2PNOTQ4KMGZZ3AF7KQM"
                alt="Second slide">
              <div class="carousel-caption d-none d-md-block">
                <p style="color: rgb(255, 249, 242);font-size: 30px;" class="m-0 font-weight-bold">Vitarana Drone </p>
                <p style="color: rgb(255, 255, 255);font-size: 19px;" class="font-weight-bold"> This is Our Vitarana
                  Drove this delivers the
                  order
                  after our <br> Vargi Bots ships the order </p>
              </div>
            </div>
            <div class="carousel-item">
              <img class="d-block w-100"
                src="https://raw.githubusercontent.com/rakshit3549/eyrcWebDashboard/main/1x/TworoboArmArtboard%201.png?token=AHUOKZA5Q6SJG7SEBY6CCMTAF7KHA"
                alt="Third slide">
              <div class="carousel-caption d-none d-md-block">
                <p style="color: rgb(255, 255, 255);font-size: 33px;" class="m-0 pl-5 font-weight-bold">Vargi Bots</p>
                <p style="color: rgb(26, 24, 24);font-size: 15px; " class="pl-5 font-weight-bold"> Our warehouse
                  cemented by the
                  ongoing
                  Fourth Industrial Revolution (Industry 4.0)</p>
              </div>
            </div>
          </div>
          <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon " aria-hidden="false"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
          </a>
        </div>
      </div>
    </div>

    <div id="dashboard" class="container-fluid">
      <div style="background-color: rgb(156, 159, 161);" class="row">
        <div class="col-sm-12 col-md-6 col-lg-6 position-relative">
          <h2 style="padding-top: 20px;" class="text-center">Incoming Orders</h2>
          <div id="map" style="height: 377px;width: auto; border-style: solid; " class="m-4"></div>
        </div>

        <div class="col-sm-12 col-md-6 col-lg-6 position-relative">
          <h2 style="padding-top: 20px;" class="text-center">Order Processing Time</h2>
          <div id="column_chart" style=" height: 380px;border-style: solid;"
            class="m-4 shadow-lg mb-5 bg-white rounded"></div>
        </div>
        <div style="background-color: rgb(255, 255, 255);" class="col-12 pt-3">
          <div class="col-12 narrow text-center mb-3">
            <h1>Dashboard</h1>
          </div>
          <div class="table-responsive">
            <table class="table table-striped table-hover table-bordered table-dark ">
              <thead class="thead-dark">
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">Team ID</th>
                  <th scope="col">Unique ID</th>
                  <th scope="col">Order ID</th>
                  <th scope="col">Item</th>
                  <th scope="col">Priority</th>
                  <th scope="col">Quantity</th>
                  <th scope="col">City</th>
                  <th scope="col">Order Dispatched</th>
                  <th scope="col">Order Shipped</th>
                </tr>
              </thead>
              <tbody id="tableContent"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>


  <div class="container-fluid">
    <div id="aboutUs">
      <div class="row">
        <div class=" col-12 narrow text-center">
          <h1>About Us</h1>
          <p>Engineering Better Tomorrow</p>
        </div>
      </div>

      <!-- <div class="jumbotron"> -->
      <div style="background-color: rgb(196, 196, 196);" class="row">
        <div class="col-sm-12 col-md-6 col-lg-6 ">
          <div>
            <h3 style="text-align: center;padding-bottom: 10px; padding-top: 35px;">Our Mission</h3>
          </div>
          <div>
            <p style="padding: 30px;">
              Delivery at its best.
              Our aim is building trust and improving the lives of our customers,
              small businesses , enterprises and also our staff and partners as
              we believe the secret to growth is helping others grow. We aim to
              reach your high priority product to the earliest.
            </p>
          </div>
        </div>

        <div class="col-sm-12 col-md-6 col-lg-6">
          <div>
            <h3 style="text-align: center; padding-bottom: 10px;padding-top: 35px">Our Vision</h3>
          </div>
          <p style="padding: 30px;">
            We are changing according to the needs of industry 4.0. Using cutting edge technology.
            Made by humans for humans – intelligent, reliable and easy to use.
            Shaping automation is our passion.
            Our pioneering spirit drives us.
            We engineer advantage. Together. Worldwide.
          </p>
        </div>
      </div>
      <!-- </div> -->
    </div>

    <!-- Contact Starts -->
    <div id="contactUs" class="offset">
      <div class="col-12 narrow text-center mb-4 mt-4">
        <h1>Contact Us</h1>
      </div>

      <!-- <div class="jumbotron"> -->
      <div style="background-color: rgb(196, 196, 196); padding-bottom: 10px;" class="row mt-2 ml">
        <div class="col-sm-6 ">
          <div style="padding-left:20px;padding-top: 25px;">
            <h6 style="margin-bottom: 10px; padding-top: 20px;">Email:<a href="mailto:eyrc.vb.0205@gmail.com">
                EYRC.VB.0205@GMAIL.COM</a></h6>
            <h6>HeadQuater: Mumbai</h6>
          </div>
        </div>
        <div class="col-sm-6">
          <p style="margin-top: 75px;" class="float-right"><a style="bottom: 0;" href="#home">Back
              to top</a></p>
        </div>
      </div>
      <!-- </div> -->
    </div>
  </div>


  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
    integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
    integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
    crossorigin="anonymous"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

  <script>

    /////////////Ajax Requests////////////
    $(document).ready(() => {
      // Fetch the initial Map
      refreshData();

      // Fetch every 5 second
      setInterval(refreshData, 5000);
    });

    var map = L.map('map').setView([20.5937, 78.9629], 4);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    google.charts.load("current", { packages: ['corechart'] });

    function refreshData() {
      var container = L.DomUtil.get('map');

      if (container != null) {
        container._leaflet_id = null;
      }

      const spreadsheetId = '1DRpS3M6MLSThYKihEjz-1nHc21xrkrU1hAK6p4PM5hM'
      fetch(`https://docs.google.com/spreadsheets/d/${spreadsheetId}/gviz/tq?tqx=out:json&sheet=Dashboard`)
        .then(res => res.text())
        .then(text => {
          console.log(text);
          const json = JSON.parse(text.substr(47).slice(0, -2))

          let count = json["table"]["rows"].length;
          var jsonDataObject = [];

          for (var i = 0; i < count; i++) {
            var json_data = {
              "City": json["table"]["rows"][i]["c"][6]["v"],
              "OderID": json["table"]["rows"][i]["c"][2]["v"],
              "Item": json["table"]["rows"][i]["c"][3]["v"],
              "Latitude": parseFloat(json["table"]["rows"][i]["c"][8]["v"]),
              "Longitude": parseFloat(json["table"]["rows"][i]["c"][7]["v"]),
              "Dispatched": json["table"]["rows"][i]["c"][9]["v"],
              "Shipped": json["table"]["rows"][i]["c"][10]["v"]
            };
            jsonDataObject.push(json_data);
          }


          // Map section
          for (var j = 0; j < jsonDataObject.length; j++) {

            if (jsonDataObject[j].Dispatched == "YES" && jsonDataObject[j].Shipped == "YES") {
              var url = "https://raw.githubusercontent.com/rakshit3549/eyrcWebDashboard/main/1x/green-marker.png?token=AHUOKZA5Q6SJG7SEBY6CCMTAF7KHA"
            } else if (jsonDataObject[j].Dispatched == "NO" && jsonDataObject[j].Shipped == "NO") {
              var url = "https://raw.githubusercontent.com/rakshit3549/eyrcWebDashboard/main/1x/red-marker.png?token=AHUOKZA5Q6SJG7SEBY6CCMTAF7KHA"
            } else {
              var url = "https://raw.githubusercontent.com/rakshit3549/eyrcWebDashboard/main/1x/gold-marker.png?token=AHUOKZA5Q6SJG7SEBY6CCMTAF7KHA"
            }

            // Add icon section
            var icon = L.icon({ iconUrl: url, iconSize: [33, 30] });
            var marker = L.marker(L.latLng(parseFloat(jsonDataObject[j].Latitude + 0.09), parseFloat(jsonDataObject[j].Longitude)), { icon });

            marker.myJsonData = jsonDataObject[j];
            marker.bindPopup((`<div>
                              <h4>City: ${marker.myJsonData.City}</h4>
                              <p>Order ID: ${marker.myJsonData.OderID} <br> 
                                Item: ${marker.myJsonData.Item} <br>
                                Dispatched: ${marker.myJsonData.Dispatched} <br>
                                Shipped: ${marker.myJsonData.Shipped}
                              </p>
                            </div>`), { closeButton: false, offset: L.point(0, -3) });
            map.addLayer(marker);
          }

          var carJsonDataObject = [];
          var graph_arr = [['Order ID', 'Time Taken', { role: 'style' }]];
          var bar_color = [];

          for (var i = 0; i < count; i++) {
            var chartJson_data = {
              "OderID": json["table"]["rows"][i]["c"][2]["f"],
              "TimeTaken": parseFloat(json["table"]["rows"][i]["c"][14]["v"]),
              "Priority": json["table"]["rows"][i]["c"][4]["v"]
            };
            carJsonDataObject.push(chartJson_data);
          };


          // Setting color for the coloumns of graph according to priority of items
          for (var j in carJsonDataObject) {
            if (carJsonDataObject[j].Priority == 'HP') {
              var color = '#e60000';
            }
            else if (carJsonDataObject[j].Priority == 'MP') {
              var color = '#f4f42a';
            }
            else if (carJsonDataObject[j].Priority == 'LP') {
              var color = '#00FF00';
            }
            bar_color.push(color)
          }

          // Converting Json Object to JavaScript Array
          for (var j in carJsonDataObject) {
            graph_arr.push([carJsonDataObject[j].OderID, carJsonDataObject[j].TimeTaken, bar_color[j]]);
          }

          var graphArray_Final = google.visualization.arrayToDataTable(graph_arr);

          var chart_data = new google.visualization.DataView(graphArray_Final);

          var options = {
            title: 'Time Taken for items to be Shipped',
            hAxis: { title: 'Order ID' },
            vAxis: { title: 'Time Taken (s)' },
            legend: { position: "none" },
          };
          var chart = new google.visualization.ColumnChart(document.getElementById('column_chart'));
          chart.draw(chart_data, options);

          var trHTML = '';
          for (var i = 0; i < count; ++i) {
            var num = i + 1
            var myData_map, myData_order;

            trHTML += '<tr><th scope="row">' + num +
              '</th><td>' + json["table"]["rows"][i]["c"][0]["v"] +
              '</td><td>' + json["table"]["rows"][i]["c"][1]["v"] +
              '</td><td>' + json["table"]["rows"][i]["c"][2]["v"] +
              '</td><td>' + json["table"]["rows"][i]["c"][3]["v"] +
              '</td><td>' + json["table"]["rows"][i]["c"][4]["v"] +
              '</td><td>' + json["table"]["rows"][i]["c"][5]["v"] +
              '</td><td>' + json["table"]["rows"][i]["c"][6]["v"] +
              '</td><td>' + json["table"]["rows"][i]["c"][9]["v"] +
              '</td><td>' + json["table"]["rows"][i]["c"][10]["v"] +
              '</td></tr>'
              ;
          }
          $('#tableContent').html(trHTML);
          var trHTML = '';

        });
    }

  </script>

</body>

</html>
