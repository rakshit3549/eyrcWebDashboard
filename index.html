<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
    integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <!-- <link rel="stylesheet" href="dashboardCss.css"> -->

  <title>Vargi Bot</title>

  <link rel="icon" href="https://raw.githubusercontent.com/rakshit3549/eyrcWebDashboard/main/1x/image-invert-crop.png" type="image/x-icon">

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
    integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
    crossorigin="" />

  <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
    integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
    crossorigin="">
    </script>

  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

  <link rel="stylesheet" href="dashboard.css">

</head>

<body>
  <main>
    <div id="home" style="background-color: rgb(105, 103, 103); width:100%;height: 1900px;" class="container-fluid p-0">

      <div class="container-fluid p-0 ">
        <img src="https://raw.githubusercontent.com/rakshit3549/eyrcWebDashboard/main/1x/FinalHeaderArtboard%201.png" alt="Header Image" class="img-fluid p-0 " alt="Responsive image">
      </div>

      <nav class="navbar  navbar-expand-lg navbar-expand-md navbar-dark sticky-top mt-3"
        style="background-color: rgba(0, 0, 0, 0.548);">
        <a class="navbar-brand" href="#">
          <img src="https://raw.githubusercontent.com/rakshit3549/eyrcWebDashboard/main/1x/image-invert-crop.png" alt="VargiBot Logo" width="40" height="40" alt="">
        </a>
        <a class="navbar-brand" href="#">वर्गी बॉट #VB0205</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse position " id="navbarSupportedContent">
          <ul class="navbar-nav text-primary mr-auto justify-content-end w-100 pr-5 ">
            <li class="nav-item active">
              <a class="nav-link" href="#home">Home <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#dashboard">Dashboard</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#aboutUs">About Us</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#contactUs">Contact Us</a>
            </li>
          </ul>
        </div>
      </nav>
      <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators">
          <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
          <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
          <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
        </ol>

        <div
          style="border-top-left-radius: 20px ; border-top-right-radius: 20px ;background-color:rgba(20, 22, 24, 0.685);"
          class=" mt-3 pt-5 pb-5">
          <div class="carousel-inner">
            <div class="carousel-item active">
              <img class="d-block w-100" src="https://raw.githubusercontent.com/rakshit3549/eyrcWebDashboard/main/1x/roboArmArtboard%201.png " alt="First slide">
              <div class="carousel-caption d-none d-md-block">
                <p style="color: rgb(224, 161, 66);font-size: 30px;" class="m-0 pl-5">Vargi Bots</p>
                <p style="color: rgb(27, 41, 59);font-size: 19px;" class="pl-5">This is our Vargi Bots,It's a UR5 arm.
                  This two pair of arms do all <br> the Shipping related Tasks </p>
              </div>
            </div>
            <div class="carousel-item">
              <img class="d-block w-100" src="https://raw.githubusercontent.com/rakshit3549/eyrcWebDashboard/main/1x/roboArmDrone1Artboard%201.png" alt="Second slide">
              <div class="carousel-caption d-none d-md-block">
                <p style="color: rgb(255, 249, 242);font-size: 30px;" class="m-0 font-weight-bold">Vitarana Drone </p>
                <p style="color: rgb(255, 255, 255);font-size: 19px;" class="font-weight-bold"> This is Our Vitarana Drove this delivers the
                  order
                  after our <br> Vargi Bots ships the order </p>
              </div>
            </div>
            <div class="carousel-item">
              <img class="d-block w-100" src="https://raw.githubusercontent.com/rakshit3549/eyrcWebDashboard/main/1x/TworoboArmArtboard%201.png" alt="Third slide">
              <div class="carousel-caption d-none d-md-block">
                <p style="color: rgb(255, 255, 255);font-size: 33px;" class="m-0 pl-5 font-weight-bold">Vargi Bots</p>
                <p style="color: rgb(26, 24, 24);font-size: 15px; " class="pl-5 font-weight-bold"> Our warehouse cemented by the
                  ongoing
                  Fourth Industrial Revolution (Industry 4.0)</p>
              </div>
            </div>
          </div>
          <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon " aria-hidden="false"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
          </a>
        </div>
      </div>

      <div id="dashboard" class="container-fluid">
        <div style="background-color: rgb(156, 159, 161);" class="row">
          <div class="col-sm-12 col-md-6 col-lg-6">
            <h2 style="padding-top: 20px;" class="text-center">Incoming Orders</h2>
            <div id="map" style="height: 380px;border-style: solid;" class="m-4 shadow-lg mb-5 bg-white rounded"></div>
          </div>
          <div class="col-sm-12 col-md-6 col-lg-6">
            <h2 style="padding-top: 20px;" class="text-center">Order Processing Time</h2>
            <div id="column_chart" style=" height: 380px;border-style: solid;"
              class="m-4 shadow-lg mb-5 bg-white rounded"></div>
          </div>
          <div style="background-color: rgb(255, 255, 255);" class="col-12 pt-3">
            <div class="col-12 narrow text-center mb-3">
              <h1>Dashboard</h1>
            </div>
            <table class="table table-striped table-hover table-bordered table-dark ">
              <thead class="thead-dark">
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">Team ID</th>
                  <th scope="col">Unique ID</th>
                  <th scope="col">Order ID</th>
                  <th scope="col">Item</th>
                  <th scope="col">Priority</th>
                  <th scope="col">Quantity</th>
                  <th scope="col">City</th>
                  <th scope="col">Order Dispatched</th>
                  <th scope="col">Order Shipped</th>
                </tr>
              </thead>
              <tbody id="tableContent"></tbody>
            </table>
          </div>
        </div>
      </div>

      <div id="aboutUs">
        <div class="col-12 narrow my-5 text-center">
          <h1>About Us</h1>
          <p>Engineering Better Tomorrow</p>
        </div>

        <div class="jumbotron">
          <div class="row">
            <div class="col-sm-1 col-md-6 ">
              <div>
                <h3 style="text-align: center;padding-bottom: 10px;">Our Mission</h3>
              </div>
              <div>
                <p style="padding: 30px;">
                  Delivery at its best.
                  Our aim is building trust and improving the lives of our customers,
                  small businesses , enterprises and also our staff and partners as
                  we believe the secret to growth is helping others grow. We aim to
                  reach your high priority product to the earliest.
                </p>
              </div>
            </div>

            <div class="col-sm-1 col-md-6">
              <div>
                <h3 style="text-align: center; padding-bottom: 10px;">Our Vision</h3>
              </div>
              <p style="padding: 30px;">
                We are changing according to the needs of industry 4.0. Using cutting edge technology.
                Made by humans for humans – intelligent, reliable and easy to use.
                Shaping automation is our passion.
                Our pioneering spirit drives us.
                We engineer advantage. Together. Worldwide.
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Contact Starts -->
      <div id="contactUs" class="offset">
        <div class="col-12 narrow text-center mb-4">
          <h1>Contact US</h1>
        </div>

        <div class="jumbotron">
          <div class="row">
            <div class="col-sm-6">
              <div>
                <h6 style="margin-bottom: 10px; padding-top: 20px;">Email:<a href="mailto:eyrc.vb.0205@gmail.com">
                    EYRC.VB.0205@GMAIL.COM</a></h6>
                <h6>HeadQuater: Mumbai</h6>
              </div>
            </div>
            <div class="col-sm-12">
              <p class="float-right m-0 pl-5"><a href="#home">Back to top</a></p>
            </div>
          </div>
        </div>
      </div>

    </div>
  </main>

  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
    integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
    integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
    crossorigin="anonymous"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

  <script>
    /////////////Ajax Requests////////////
    $(document).ready(function () {
      // Fetch the initial Map
      refreshData();

      // Fetch every 5 second
      setInterval(refreshData, 5000);
    });

    var map = L.map('map').setView([20.5937, 78.9629], 4);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    google.charts.load("current", { packages: ['corechart'] });

    function refreshData() {
      var container = L.DomUtil.get('map');

      if (container != null) {
        container._leaflet_id = null;
      }

      var jsonDataObject = [];

      $.getJSON('https://spreadsheets.google.com/feeds/list/1Mwq0p_xGAfNjDStlrIZpSGYfa-lUPLr7j79-OST82Zk/5/public/full?alt=json', function (data) {
        for (var i = 0; i < data.feed.entry.length; ++i) {

          var json_data = {
            "City": data.feed.entry[i].gsx$city.$t,
            "OderID": data.feed.entry[i].gsx$orderid.$t,
            "Item": data.feed.entry[i].gsx$item.$t,
            "Latitude": parseFloat(data.feed.entry[i].gsx$latitude.$t),
            "Longitude": parseFloat(data.feed.entry[i].gsx$longitude.$t)
          };
          jsonDataObject.push(json_data);

          for (var j = 0; j < jsonDataObject.length; j++) {
            // console.log(jsonDataObject[j])

            if (jsonDataObject[j].Item == "Medicine") {
              var url = "https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png"
            } else if (jsonDataObject[j].Item == "Food") {
              var url = "https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-gold.png"
            } else {
              var url = "https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-green.png"
            }

            var icon = L.icon({
              iconUrl: url,
              iconSize: [15, 22]
            });

            var marker = L.marker(L.latLng(parseFloat(jsonDataObject[j].Latitude), parseFloat(jsonDataObject[j].Longitude)), { icon });
            marker.myJsonData = jsonDataObject[j];
            marker.bindPopup((`<div>
                                        <h4>City: ${marker.myJsonData.City}</h4>
                                        <p>Order ID: ${marker.myJsonData.OderID} <br> Item: ${marker.myJsonData.Item}</p>
                                    </div>`), { closeButton: false, offset: L.point(0, -7) });
            map.addLayer(marker);
            // marker.on('click', onClick_Marker)
            // Attach the corresponding JSON data to your marker:
            marker.myJsonData = jsonDataObject[j];

          }
        }

        console.log("!!!!!!!!", data.feed.entry[0].gsx$timetaken.$t)
        // console.log("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!")
        var carJsonDataObject = [];
        var graph_arr = [['Order ID', 'Time Taken', { role: 'style' }]];
        var bar_color = [];

        for (var i = 0; i < data.feed.entry.length; ++i) {
          var chartJson_data = {
            "OderID": data.feed.entry[i].gsx$orderid.$t,
            "TimeTaken": parseFloat(data.feed.entry[i].gsx$timetaken.$t),
            "Priority": data.feed.entry[i].gsx$priority.$t
          };
          carJsonDataObject.push(chartJson_data);
        };
        // Setting color for the coloumns of graph according to priority of items
        for (var j in carJsonDataObject) {
          if (carJsonDataObject[j].Priority == 'HP') {
            var color = '#e60000';
          }
          else if (carJsonDataObject[j].Priority == 'MP') {
            var color = '#f4f42a';
          }
          else if (carJsonDataObject[j].Priority == 'LP') {
            var color = '#00FF00';
          }
          bar_color.push(color)
        }
        // Converting Json Object to JavaScript Array

        for (var j in carJsonDataObject) {
          graph_arr.push([carJsonDataObject[j].OderID, carJsonDataObject[j].TimeTaken, bar_color[j]]);
        }
        var graphArray_Final = google.visualization.arrayToDataTable(graph_arr);

        var chardata = new google.visualization.DataView(graphArray_Final);

        var options = {
          title: 'Time Taken for items to be Shipped',
          hAxis: { title: 'Order ID' },
          vAxis: { title: 'Time Taken (s)' },
          legend: { position: "none" },
        };
        var chart = new google.visualization.ColumnChart(document.getElementById('column_chart'));
        chart.draw(chardata, options);

        var trHTML = '';
        for (var i = 0; i < data.feed.entry.length; ++i) {
          var num = i + 1
          var myData_map, myData_order;

          trHTML += '<tr><th scope="row">' + num +
            '</th><td>' + data.feed.entry[i].gsx$teamid.$t +
            '</td><td>' + data.feed.entry[i].gsx$uniqueid.$t +
            '</td><td>' + data.feed.entry[i].gsx$orderid.$t +
            '</td><td>' + data.feed.entry[i].gsx$item.$t +
            '</td><td>' + data.feed.entry[i].gsx$priority.$t +
            '</td><td>' + data.feed.entry[i].gsx$quantity.$t +
            '</td><td>' + data.feed.entry[i].gsx$city.$t +
            '</td><td>' + data.feed.entry[i].gsx$orderdispatched.$t +
            '</td><td>' + data.feed.entry[i].gsx$ordershipped.$t +
            '</td></tr>'
            ;
        }
        console.log(trHTML);
        $('#tableContent').html(trHTML);
        var trHTML = '';

      });
    }

  </script>

</body>

</html>